# CI test: routes + extraRoutes combined (merged from extra-routes-values.yaml)
# Refer to this file for a full example of how to configure both route types.
routes:
  # - hostname of the route, will be matched against the host header of the request
  # currently defaults to one, if ever more are needed open an issue, `extraHostNames` will be added, supports templating
  hostname: chart-testing-service.example.com
  # -- gateway to use
  gateway:
    # -- name of the gateway
    # @default -- kong
    name: kong
    # -- namespace of the gateway
    # @default -- system
    namespace: system
  # -- pathPrefix allows setting the default prefix (fullname) for all paths
  # @default -- defaults to the fullname of the service
  pathPrefix: ""
  # -- Global timeout for all routes (GEP-2257), can be overridden per-path
  timeout: "30s"
  paths:
    default:
      enabled: true
      blockList:
        - /metrics
        - /sensitive
      extraAnnotations: {}
      #   konghq.com/request-buffering: "false"
      #   konghq.com/read-timeout: "120s"
      # Override global timeout for this path
      timeout: "60s"
    versioned:
      enabled: true
      # -- users wishing to not call their versioned API 'public' can override the path
      # ⚠️ Customizing this value requires also changing the default url in multiple places including all SDK or integration use cases
      # @default -- the chart will default to 'public' to stay backward compatible
      pathOverride: /public
      extraAnnotations: {}
      #   konghq.com/request-buffering: "false"
      # Override global timeout with per-path convenience timeout
      timeout: "120s"
    scoped:
      enabled: true
      pathOverride: /scoped
      # allowList: strings or objects (type: Exact default, PathPrefix requires methods)
      allowList:
        - /upload
        - /download
        - path: /html-store
          type: PathPrefix
          methods:
            - GET
      extraAnnotations: {}
      # Inherits global timeout: "30s"
    # -- `/probe` is unauthorized and its sole purpose is to expose a health check endpoint for availability monitoring
    # Maps to version neutral `/probe` endpoint all Unique services expose
    probe:
      enabled: true
      extraAnnotations: {}
      #   konghq.com/strip-path: "true"
      # Short timeout for probe endpoint
      timeout: "5s"

# Extra routes using raw Gateway API HTTPRoute spec (for non-Kong gateways or custom routes)
extraRoutes:
  extra-route-1:
    enabled: true
    parentRefs:
      - name: kong
        namespace: kong-system
        group: gateway.networking.k8s.io
        kind: Gateway
    hostnames:
      - my.api.example.com
    matches:
      - path:
          type: PathPrefix
          value: /extra-route-1
    filters: []
    additionalRules: []
    timeouts:
      request: 60s
      backendRequest: 60s
  extra-route-2:
    enabled: true
    parentRefs:
      - name: kong
        namespace: kong-system
        group: gateway.networking.k8s.io
        kind: Gateway
    hostnames:
      - my.api.example.com
    matches:
      - path:
          type: PathPrefix
          value: /extra-route-2
    filters: []
    additionalRules: []
    timeouts:
      request: 120s
      backendRequest: 60s
